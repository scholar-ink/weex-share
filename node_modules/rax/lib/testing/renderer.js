'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _driver = require('../driver');

var _injectComponent = require('../vdom/injectComponent');

var _injectComponent2 = _interopRequireDefault(_injectComponent);

var _instance = require('../vdom/instance');

var _instance2 = _interopRequireDefault(_instance);

var _server = require('../drivers/server');

var _server2 = _interopRequireDefault(_server);

var _serializer = require('../server/serializer');

var _serializer2 = _interopRequireDefault(_serializer);

var _unmountComponentAtNode = require('../unmountComponentAtNode');

var _unmountComponentAtNode2 = _interopRequireDefault(_unmountComponentAtNode);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = {
  create: function create(element) {
    (0, _injectComponent2.default)();
    (0, _driver.setDriver)(_server2.default);

    var container = _server2.default.createBody();
    var rootComponent = _instance2.default.render(element, container);
    var renderedComponent = rootComponent.getRenderedComponent();

    renderedComponent.toJSON = function () {
      return new _serializer2.default(container).toJSON();
    };

    renderedComponent.getInstance = function () {
      return renderedComponent._instance;
    };

    renderedComponent.update = function (element) {
      _instance2.default.render(element, container);
    };

    renderedComponent.unmount = function () {
      (0, _unmountComponentAtNode2.default)(container);
    };

    return renderedComponent;
  }
};